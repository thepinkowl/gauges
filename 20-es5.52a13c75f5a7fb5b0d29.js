function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_unsupportedIterableToArray(n)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(n,t){if(n){if("string"==typeof n)return _arrayLikeToArray(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(n,t):void 0}}function _iterableToArray(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}function _arrayWithoutHoles(n){if(Array.isArray(n))return _arrayLikeToArray(n)}function _arrayLikeToArray(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=n[e];return i}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function _createClass(n,t,e){return t&&_defineProperties(n.prototype,t),e&&_defineProperties(n,e),n}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{S4AJ:function(n,t,e){"use strict";e.r(t),e.d(t,"TaskDetailPageModule",(function(){return P}));var i=e("ofXK"),o=e("3Pt+"),r=e("TEn/"),a=e("tyNb"),c=e("mrSG"),s=e("Mwlb"),l=e("fXoL"),u=e("ptfe"),b=e("hMga");function d(n,t){if(1&n&&(l.Nb(0,"ion-select-option",14),l.nc(1),l.Mb()),2&n){var e=t.$implicit;l.dc("value",e.gid),l.Ab(1),l.oc(e.name)}}function f(n,t){if(1&n){var e=l.Ob();l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"Put it in a group"),l.Mb(),l.Nb(3,"ion-select",12),l.Vb("ngModelChange",(function(n){return l.hc(e),l.Xb().task.gid=n})),l.mc(4,d,2,2,"ion-select-option",13),l.Yb(5,"async"),l.Mb(),l.Mb()}if(2&n){var i=l.Xb();l.Ab(3),l.dc("ngModel",i.task.gid),l.Ab(1),l.dc("ngForOf",l.Zb(5,2,i.groupsService.groups))}}function g(n,t){if(1&n){var e=l.Ob();l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"When did you last do this?"),l.Mb(),l.Nb(3,"ion-datetime",15),l.Vb("ionChange",(function(n){return l.hc(e),l.Xb().onChange(n)})),l.Mb(),l.Mb()}if(2&n){var i=l.Xb();l.Ab(3),l.dc("max",i.now.toISOString())("value",i.lastExecution)}}function m(n,t){if(1&n){var e=l.Ob();l.Nb(0,"ion-item-sliding"),l.Nb(1,"ion-item"),l.Nb(2,"ion-label"),l.nc(3),l.Mb(),l.Mb(),l.Nb(4,"ion-item-options",18),l.Nb(5,"ion-item-option",19),l.Vb("click",(function(n){l.hc(e);var i=t.index;return l.Xb(2).deleteTime(n,i)})),l.nc(6,"delete"),l.Mb(),l.Mb(),l.Mb()}if(2&n){var i=t.$implicit;l.Ab(3),l.qc("",i.toLocaleDateString()," ",i.toLocaleTimeString(),"")}}function h(n,t){if(1&n&&(l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"Last executions (showing 5 most recent)"),l.Mb(),l.Nb(3,"ion-list",16),l.mc(4,m,7,2,"ion-item-sliding",17),l.Yb(5,"slice"),l.Mb(),l.Mb()),2&n){var e=l.Xb();l.Ab(4),l.dc("ngForOf",l.ac(5,1,e.task.executions,0,5))}}function p(n,t){if(1&n){var e=l.Ob();l.Nb(0,"ion-button",20),l.Vb("click",(function(){return l.hc(e),l.Xb().create()})),l.nc(1,"Create"),l.Mb()}}function M(n,t){if(1&n){var e=l.Ob();l.Nb(0,"ion-button",20),l.Vb("click",(function(){return l.hc(e),l.Xb().update()})),l.nc(1,"Update"),l.Mb()}}function v(n,t){if(1&n){var e=l.Ob();l.Nb(0,"ion-button",21),l.Vb("click",(function(){return l.hc(e),l.Xb().delete()})),l.nc(1,"Remove this task"),l.Mb()}}var k,_,C,y=[{path:"",component:(k=function(){function n(t,e,i,o){_classCallCheck(this,n),this.nav=t,this.tasksService=e,this.groupsService=i,this.activatedRoute=o,this.now=new Date,this.task=s.a.createEmpty(),this.new=!0,this.lastExecution=this.now.toISOString()}return _createClass(n,[{key:"onChange",value:function(n){var t=new Date(n.detail.value);this.task.executions=[t],this.task.computeProgress()}},{key:"deleteTime",value:function(n,t){this.lastExecution=void 0;var e=_toConsumableArray(this.task.executions);e.splice(t,1),this.task.executions=e}},{key:"ngOnInit",value:function(){var n=this;this.activatedRoute.params.subscribe((function(t){return Object(c.__awaiter)(n,void 0,void 0,regeneratorRuntime.mark((function n(){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.new="new"===t.id,this.new){n.next=5;break}return n.next=3,this.tasksService.getTaskById(t.id);case 3:e=n.sent,this.task=e,this.lastExecution=e.lastDone.toISOString();case 5:this.task.computeProgress();case 6:case"end":return n.stop()}}),n,this)})))}))}},{key:"goBack",value:function(){this.task.computeProgress(),window.history.length>2?this.nav.back():this.nav.navigateBack("/")}},{key:"create",value:function(){return Object(c.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.new){n.next=6;break}if(this.task.gid&&""!==this.task.gid){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,this.tasksService.createTask(this.task);case 5:this.goBack();case 6:case"end":return n.stop()}}),n,this)})))}},{key:"update",value:function(){return Object(c.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=this.new,n.t0){n.next=5;break}return n.next=4,this.tasksService.updateTask(this.task);case 4:this.goBack();case 5:case"end":return n.stop()}}),n,this)})))}},{key:"delete",value:function(){this.new||(this.tasksService.deleteTask(this.task),this.goBack())}}]),n}(),k.\u0275fac=function(n){return new(n||k)(l.Kb(r.u),l.Kb(u.a),l.Kb(b.a),l.Kb(a.a))},k.\u0275cmp=l.Eb({type:k,selectors:[["app-task-detail"]],decls:26,vars:9,consts:[[3,"fullscreen"],[1,"form"],[1,"cancel-button"],["fill","clear",3,"click"],[1,"form-element"],[1,"title"],[3,"ngModel","ngModelChange"],["class","form-element",4,"ngIf"],[1,"repeat-selector"],[1,"actions"],["expand","block","color","primary",3,"click",4,"ngIf"],["fill","clear","color","danger",3,"click",4,"ngIf"],["placeholder","Group",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["displayFormat","DDDD MMM D, YYYY",3,"max","value","ionChange"],["id","history"],[4,"ngFor","ngForOf"],["side","end"],["color","danger",3,"click"],["expand","block","color","primary",3,"click"],["fill","clear","color","danger",3,"click"]],template:function(n,t){1&n&&(l.Nb(0,"ion-content",0),l.Nb(1,"main"),l.Nb(2,"div",1),l.Nb(3,"div",2),l.Nb(4,"ion-button",3),l.Vb("click",(function(){return t.goBack()})),l.nc(5,"Cancel"),l.Mb(),l.Mb(),l.Nb(6,"div",4),l.Nb(7,"div",5),l.nc(8,"Let's give it a name!"),l.Mb(),l.Nb(9,"ion-input",6),l.Vb("ngModelChange",(function(n){return t.task.name=n})),l.Mb(),l.Mb(),l.mc(10,f,6,4,"div",7),l.Nb(11,"div",4),l.Nb(12,"div",5),l.nc(13,"When do you usually do this task?"),l.Mb(),l.Nb(14,"div",8),l.Nb(15,"span"),l.nc(16," Every "),l.Mb(),l.Nb(17,"ion-input",6),l.Vb("ngModelChange",(function(n){return t.task.repeat=n})),l.Mb(),l.Nb(18,"span"),l.nc(19," days "),l.Mb(),l.Mb(),l.Mb(),l.mc(20,g,4,2,"div",7),l.mc(21,h,6,5,"div",7),l.Mb(),l.Nb(22,"div",9),l.mc(23,p,2,0,"ion-button",10),l.mc(24,M,2,0,"ion-button",10),l.mc(25,v,2,0,"ion-button",11),l.Mb(),l.Mb(),l.Mb()),2&n&&(l.dc("fullscreen",!0),l.Ab(9),l.dc("ngModel",t.task.name),l.Ab(1),l.dc("ngIf",t.new),l.Ab(7),l.dc("ngModel",t.task.repeat),l.Ab(3),l.dc("ngIf",t.new||0===t.task.executions.length),l.Ab(1),l.dc("ngIf",!t.new&&0!==t.task.executions.length),l.Ab(2),l.dc("ngIf",t.new),l.Ab(1),l.dc("ngIf",!t.new),l.Ab(1),l.dc("ngIf",!t.new))},directives:[r.d,r.c,r.h,r.y,o.c,o.d,i.k,r.q,r.x,i.j,r.r,r.e,r.n,r.l,r.i,r.m,r.k,r.j],pipes:[i.b,i.o],styles:["[_nghost-%COMP%]   main[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%;padding-bottom:calc(env(safe-area-inset-bottom) + 10px)}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;font-weight:700}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]{padding:10px 20px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%], [_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:1px solid var(--ion-color-light)}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{padding:0 10px!important}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;max-width:70%;padding:20px 0 10px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   div.repeat-selector[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   div.repeat-selector[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:0 10px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:0 40px}"]}),k)}],O=((C=function n(){_classCallCheck(this,n)}).\u0275mod=l.Ib({type:C}),C.\u0275inj=l.Hb({factory:function(n){return new(n||C)},imports:[[a.i.forChild(y)],a.i]}),C),P=((_=function n(){_classCallCheck(this,n)}).\u0275mod=l.Ib({type:_}),_.\u0275inj=l.Hb({factory:function(n){return new(n||_)},imports:[[i.c,o.a,r.s,O]]}),_)}}]);