function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,o=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{S4AJ:function(t,e,n){"use strict";n.r(e),n.d(e,"TaskDetailPageModule",(function(){return C}));var o,r=n("ofXK"),i=n("3Pt+"),a=n("TEn/"),c=n("tyNb"),s=n("mrSG"),u=((o=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var o;return _classCallCheck(this,n),o=e.call(this),Object.assign(_assertThisInitialized(o),t),o.computeProgress(),o}return _createClass(n,[{key:"computeProgress",value:function(){this.executions.sort((function(t,e){return e.getTime()-t.getTime()})),this.lastDone=this.executions[0];var t=n.today-this.lastDone.getTime(),e=Math.floor(n.DAY*Math.max(this.repeat,1)*1.2);this.progress=this.rangePercentage(Math.floor((e-t)/e*100))}},{key:"rangePercentage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return Math.min(Math.max(t,e),n)}}],[{key:"parseTasks",value:function(t){return t.map((function(t){return new n(t)}))}},{key:"createEmpty",value:function(){return new n({name:"",gid:"",id:"",repeat:7,executions:[new Date]})}}]),n}(function(){return function t(){_classCallCheck(this,t)}}())).today=Date.now(),o.HOUR=36e5,o.DAY=24*o.HOUR,o.WEEK=7*o.DAY,o),l=n("fXoL"),f=n("ptfe");function b(t,e){if(1&t){var n=l.Ob();l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"Put it in a group"),l.Mb(),l.Nb(3,"ion-select",12),l.Vb("ngModelChange",(function(t){return l.hc(n),l.Xb().task.gid=t})),l.Nb(4,"ion-select-option",13),l.nc(5,"Nice"),l.Mb(),l.Mb(),l.Mb()}if(2&t){var o=l.Xb();l.Ab(3),l.dc("ngModel",o.task.gid)}}function g(t,e){if(1&t){var n=l.Ob();l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"When did you last do this?"),l.Mb(),l.Nb(3,"ion-datetime",14),l.Vb("ionChange",(function(t){return l.hc(n),l.Xb().onChange(t)})),l.Mb(),l.Mb()}if(2&t){var o=l.Xb();l.Ab(3),l.dc("max",o.now.toISOString())("value",o.lastExecution)}}function d(t,e){if(1&t){var n=l.Ob();l.Nb(0,"ion-item-sliding"),l.Nb(1,"ion-item"),l.Nb(2,"ion-label"),l.nc(3),l.Mb(),l.Mb(),l.Nb(4,"ion-item-options",17),l.Nb(5,"ion-item-option",18),l.Vb("click",(function(t){l.hc(n);var o=e.index;return l.Xb(2).deleteTime(t,o)})),l.nc(6,"delete"),l.Mb(),l.Mb(),l.Mb()}if(2&t){var o=e.$implicit;l.Ab(3),l.qc("",o.toLocaleDateString()," ",o.toLocaleTimeString(),"")}}function h(t,e){if(1&t&&(l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"Last executions (showing 5 most recent)"),l.Mb(),l.Nb(3,"ion-list",15),l.mc(4,d,7,2,"ion-item-sliding",16),l.Yb(5,"slice"),l.Mb(),l.Mb()),2&t){var n=l.Xb();l.Ab(4),l.dc("ngForOf",l.ac(5,1,n.task.executions,0,5))}}function p(t,e){if(1&t){var n=l.Ob();l.Nb(0,"ion-button",19),l.Vb("click",(function(){return l.hc(n),l.Xb().create()})),l.nc(1,"Create"),l.Mb()}}function m(t,e){if(1&t){var n=l.Ob();l.Nb(0,"ion-button",19),l.Vb("click",(function(){return l.hc(n),l.Xb().update()})),l.nc(1,"Update"),l.Mb()}}function _(t,e){if(1&t){var n=l.Ob();l.Nb(0,"ion-button",20),l.Vb("click",(function(){return l.hc(n),l.Xb().delete()})),l.nc(1,"Remove this task"),l.Mb()}}var v,M,y,k=[{path:"",component:(v=function(){function t(e,n,o){_classCallCheck(this,t),this.nav=e,this.tasksService=n,this.activatedRoute=o,this.now=new Date,this.task=u.createEmpty(),this.new=!0,this.lastExecution=this.now.toISOString()}return _createClass(t,[{key:"onChange",value:function(t){var e=new Date(t.detail.value);this.task.executions=[e],this.task.computeProgress()}},{key:"deleteTime",value:function(t,e){this.lastExecution=void 0;var n=_toConsumableArray(this.task.executions);n.splice(e,1),this.task.executions=n}},{key:"ngOnInit",value:function(){var t=this;this.activatedRoute.params.subscribe((function(e){return Object(s.__awaiter)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.new="new"===e.id,this.new){t.next=5;break}return t.next=3,this.tasksService.getTaskById(e.id);case 3:n=t.sent,this.task=n,this.lastExecution=n.lastDone.toISOString();case 5:this.task.computeProgress();case 6:case"end":return t.stop()}}),t,this)})))}))}},{key:"goBack",value:function(){this.task.computeProgress(),window.history.length>2?this.nav.back():this.nav.navigateBack("/")}},{key:"create",value:function(){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.new){t.next=7;break}if(this.task.gid&&""!==this.task.gid){t.next=3;break}return t.abrupt("return");case 3:return console.log(this.task),t.next=6,this.tasksService.createTask(this.task);case 6:this.goBack();case 7:case"end":return t.stop()}}),t,this)})))}},{key:"update",value:function(){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.new,t.t0){t.next=5;break}return t.next=4,this.tasksService.updateTask(this.task);case 4:this.goBack();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"delete",value:function(){this.new||(this.tasksService.deleteTask(this.task),this.goBack())}}]),t}(),v.\u0275fac=function(t){return new(t||v)(l.Kb(a.u),l.Kb(f.a),l.Kb(c.a))},v.\u0275cmp=l.Eb({type:v,selectors:[["app-task-detail"]],decls:26,vars:9,consts:[[3,"fullscreen"],[1,"form"],[1,"cancel-button"],["fill","clear",3,"click"],[1,"form-element"],[1,"title"],[3,"ngModel","ngModelChange"],["class","form-element",4,"ngIf"],[1,"repeat-selector"],[1,"actions"],["expand","block","color","primary",3,"click",4,"ngIf"],["fill","clear","color","danger",3,"click",4,"ngIf"],["placeholder","Group",3,"ngModel","ngModelChange"],["value","N2s035RLFqgU0gDJjCx2"],["displayFormat","DDDD MMM D, YYYY",3,"max","value","ionChange"],["id","history"],[4,"ngFor","ngForOf"],["side","end"],["color","danger",3,"click"],["expand","block","color","primary",3,"click"],["fill","clear","color","danger",3,"click"]],template:function(t,e){1&t&&(l.Nb(0,"ion-content",0),l.Nb(1,"main"),l.Nb(2,"div",1),l.Nb(3,"div",2),l.Nb(4,"ion-button",3),l.Vb("click",(function(){return e.goBack()})),l.nc(5,"Cancel"),l.Mb(),l.Mb(),l.Nb(6,"div",4),l.Nb(7,"div",5),l.nc(8,"Let's give it a name!"),l.Mb(),l.Nb(9,"ion-input",6),l.Vb("ngModelChange",(function(t){return e.task.name=t})),l.Mb(),l.Mb(),l.mc(10,b,6,1,"div",7),l.Nb(11,"div",4),l.Nb(12,"div",5),l.nc(13,"When do you usually do this task?"),l.Mb(),l.Nb(14,"div",8),l.Nb(15,"span"),l.nc(16," Every "),l.Mb(),l.Nb(17,"ion-input",6),l.Vb("ngModelChange",(function(t){return e.task.repeat=t})),l.Mb(),l.Nb(18,"span"),l.nc(19," days "),l.Mb(),l.Mb(),l.Mb(),l.mc(20,g,4,2,"div",7),l.mc(21,h,6,5,"div",7),l.Mb(),l.Nb(22,"div",9),l.mc(23,p,2,0,"ion-button",10),l.mc(24,m,2,0,"ion-button",10),l.mc(25,_,2,0,"ion-button",11),l.Mb(),l.Mb(),l.Mb()),2&t&&(l.dc("fullscreen",!0),l.Ab(9),l.dc("ngModel",e.task.name),l.Ab(1),l.dc("ngIf",e.new),l.Ab(7),l.dc("ngModel",e.task.repeat),l.Ab(3),l.dc("ngIf",e.new||0===e.task.executions.length),l.Ab(1),l.dc("ngIf",!e.new&&0!==e.task.executions.length),l.Ab(2),l.dc("ngIf",e.new),l.Ab(1),l.dc("ngIf",!e.new),l.Ab(1),l.dc("ngIf",!e.new))},directives:[a.d,a.c,a.h,a.y,i.c,i.d,r.k,a.q,a.x,a.r,a.e,a.n,r.j,a.l,a.i,a.m,a.k,a.j],pipes:[r.o],styles:["[_nghost-%COMP%]   main[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%;padding-bottom:calc(env(safe-area-inset-bottom) + 10px)}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;font-weight:700}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]{padding:10px 20px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%], [_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:1px solid var(--ion-color-light)}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{padding:0 10px!important}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;max-width:70%;padding:20px 0 10px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   div.repeat-selector[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   div.repeat-selector[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:0 10px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:0 40px}"]}),v)}],O=((y=function t(){_classCallCheck(this,t)}).\u0275mod=l.Ib({type:y}),y.\u0275inj=l.Hb({factory:function(t){return new(t||y)},imports:[[c.i.forChild(k)],c.i]}),y),C=((M=function t(){_classCallCheck(this,t)}).\u0275mod=l.Ib({type:M}),M.\u0275inj=l.Hb({factory:function(t){return new(t||M)},imports:[[r.c,i.a,a.s,O]]}),M)}}]);