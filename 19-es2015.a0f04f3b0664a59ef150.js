(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{S4AJ:function(t,n,e){"use strict";e.r(n),e.d(n,"TaskDetailPageModule",(function(){return k}));var i=e("ofXK"),o=e("3Pt+"),c=e("TEn/"),s=e("tyNb"),a=e("mrSG"),r=(()=>{class t extends class{}{constructor(t){super(),Object.assign(this,t),this.computeProgress()}static parseTasks(n){return n.map(n=>new t(n))}static createEmpty(){return new t({name:"",gid:"",id:"",repeat:7,executions:[new Date]})}computeProgress(){this.executions.sort((t,n)=>n.getTime()-t.getTime()),this.lastDone=this.executions[0];const n=t.today-this.lastDone.getTime(),e=Math.floor(t.DAY*Math.max(this.repeat,1)*1.2);this.progress=this.rangePercentage(Math.floor((e-n)/e*100))}rangePercentage(t,n=0,e=100){return Math.min(Math.max(t,n),e)}}return t.today=Date.now(),t.HOUR=36e5,t.DAY=24*t.HOUR,t.WEEK=7*t.DAY,t})(),l=e("fXoL"),b=e("ptfe");function g(t,n){if(1&t){const t=l.Ob();l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"Put it in a group"),l.Mb(),l.Nb(3,"ion-select",12),l.Vb("ngModelChange",(function(n){return l.hc(t),l.Xb().task.gid=n})),l.Nb(4,"ion-select-option",13),l.nc(5,"Nice"),l.Mb(),l.Mb(),l.Mb()}if(2&t){const t=l.Xb();l.Ab(3),l.dc("ngModel",t.task.gid)}}function d(t,n){if(1&t){const t=l.Ob();l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"When did you last do this?"),l.Mb(),l.Nb(3,"ion-datetime",14),l.Vb("ionChange",(function(n){return l.hc(t),l.Xb().onChange(n)})),l.Mb(),l.Mb()}if(2&t){const t=l.Xb();l.Ab(3),l.dc("max",t.now.toISOString())("value",t.lastExecution)}}function u(t,n){if(1&t){const t=l.Ob();l.Nb(0,"ion-item-sliding"),l.Nb(1,"ion-item"),l.Nb(2,"ion-label"),l.nc(3),l.Mb(),l.Mb(),l.Nb(4,"ion-item-options",17),l.Nb(5,"ion-item-option",18),l.Vb("click",(function(e){l.hc(t);const i=n.index;return l.Xb(2).deleteTime(e,i)})),l.nc(6,"delete"),l.Mb(),l.Mb(),l.Mb()}if(2&t){const t=n.$implicit;l.Ab(3),l.qc("",t.toLocaleDateString()," ",t.toLocaleTimeString(),"")}}function h(t,n){if(1&t&&(l.Nb(0,"div",4),l.Nb(1,"div",5),l.nc(2,"Last executions (showing 5 most recent)"),l.Mb(),l.Nb(3,"ion-list",15),l.mc(4,u,7,2,"ion-item-sliding",16),l.Yb(5,"slice"),l.Mb(),l.Mb()),2&t){const t=l.Xb();l.Ab(4),l.dc("ngForOf",l.ac(5,1,t.task.executions,0,5))}}function m(t,n){if(1&t){const t=l.Ob();l.Nb(0,"ion-button",19),l.Vb("click",(function(){return l.hc(t),l.Xb().create()})),l.nc(1,"Create"),l.Mb()}}function M(t,n){if(1&t){const t=l.Ob();l.Nb(0,"ion-button",19),l.Vb("click",(function(){return l.hc(t),l.Xb().update()})),l.nc(1,"Update"),l.Mb()}}function f(t,n){if(1&t){const t=l.Ob();l.Nb(0,"ion-button",20),l.Vb("click",(function(){return l.hc(t),l.Xb().delete()})),l.nc(1,"Remove this task"),l.Mb()}}const p=[{path:"",component:(()=>{class t{constructor(t,n,e){this.nav=t,this.tasksService=n,this.activatedRoute=e,this.now=new Date,this.task=r.createEmpty(),this.new=!0,this.lastExecution=this.now.toISOString()}onChange(t){const n=new Date(t.detail.value);this.task.executions=[n],this.task.computeProgress()}deleteTime(t,n){this.lastExecution=void 0;const e=[...this.task.executions];e.splice(n,1),this.task.executions=e}ngOnInit(){this.activatedRoute.params.subscribe(t=>Object(a.__awaiter)(this,void 0,void 0,(function*(){if(this.new="new"===t.id,!this.new){const n=yield this.tasksService.getTaskById(t.id);this.task=n,this.lastExecution=n.lastDone.toISOString()}this.task.computeProgress()})))}goBack(){this.task.computeProgress(),window.history.length>2?this.nav.back():this.nav.navigateBack("/")}create(){return Object(a.__awaiter)(this,void 0,void 0,(function*(){if(this.new){if(!this.task.gid||""===this.task.gid)return;console.log(this.task),yield this.tasksService.createTask(this.task),this.goBack()}}))}update(){return Object(a.__awaiter)(this,void 0,void 0,(function*(){this.new||(yield this.tasksService.updateTask(this.task),this.goBack())}))}delete(){this.new||(this.tasksService.deleteTask(this.task),this.goBack())}}return t.\u0275fac=function(n){return new(n||t)(l.Kb(c.u),l.Kb(b.a),l.Kb(s.a))},t.\u0275cmp=l.Eb({type:t,selectors:[["app-task-detail"]],decls:26,vars:9,consts:[[3,"fullscreen"],[1,"form"],[1,"cancel-button"],["fill","clear",3,"click"],[1,"form-element"],[1,"title"],[3,"ngModel","ngModelChange"],["class","form-element",4,"ngIf"],[1,"repeat-selector"],[1,"actions"],["expand","block","color","primary",3,"click",4,"ngIf"],["fill","clear","color","danger",3,"click",4,"ngIf"],["placeholder","Group",3,"ngModel","ngModelChange"],["value","N2s035RLFqgU0gDJjCx2"],["displayFormat","DDDD MMM D, YYYY",3,"max","value","ionChange"],["id","history"],[4,"ngFor","ngForOf"],["side","end"],["color","danger",3,"click"],["expand","block","color","primary",3,"click"],["fill","clear","color","danger",3,"click"]],template:function(t,n){1&t&&(l.Nb(0,"ion-content",0),l.Nb(1,"main"),l.Nb(2,"div",1),l.Nb(3,"div",2),l.Nb(4,"ion-button",3),l.Vb("click",(function(){return n.goBack()})),l.nc(5,"Cancel"),l.Mb(),l.Mb(),l.Nb(6,"div",4),l.Nb(7,"div",5),l.nc(8,"Let's give it a name!"),l.Mb(),l.Nb(9,"ion-input",6),l.Vb("ngModelChange",(function(t){return n.task.name=t})),l.Mb(),l.Mb(),l.mc(10,g,6,1,"div",7),l.Nb(11,"div",4),l.Nb(12,"div",5),l.nc(13,"When do you usually do this task?"),l.Mb(),l.Nb(14,"div",8),l.Nb(15,"span"),l.nc(16," Every "),l.Mb(),l.Nb(17,"ion-input",6),l.Vb("ngModelChange",(function(t){return n.task.repeat=t})),l.Mb(),l.Nb(18,"span"),l.nc(19," days "),l.Mb(),l.Mb(),l.Mb(),l.mc(20,d,4,2,"div",7),l.mc(21,h,6,5,"div",7),l.Mb(),l.Nb(22,"div",9),l.mc(23,m,2,0,"ion-button",10),l.mc(24,M,2,0,"ion-button",10),l.mc(25,f,2,0,"ion-button",11),l.Mb(),l.Mb(),l.Mb()),2&t&&(l.dc("fullscreen",!0),l.Ab(9),l.dc("ngModel",n.task.name),l.Ab(1),l.dc("ngIf",n.new),l.Ab(7),l.dc("ngModel",n.task.repeat),l.Ab(3),l.dc("ngIf",n.new||0===n.task.executions.length),l.Ab(1),l.dc("ngIf",!n.new&&0!==n.task.executions.length),l.Ab(2),l.dc("ngIf",n.new),l.Ab(1),l.dc("ngIf",!n.new),l.Ab(1),l.dc("ngIf",!n.new))},directives:[c.d,c.c,c.h,c.y,o.c,o.d,i.k,c.q,c.x,c.r,c.e,c.n,i.j,c.l,c.i,c.m,c.k,c.j],pipes:[i.o],styles:["[_nghost-%COMP%]   main[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%;padding-bottom:calc(env(safe-area-inset-bottom) + 10px)}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;font-weight:700}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]{padding:10px 20px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%], [_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:1px solid var(--ion-color-light)}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{padding:0 10px!important}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;max-width:70%;padding:20px 0 10px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   div.repeat-selector[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-element[_ngcontent-%COMP%]   div.repeat-selector[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:0 10px}[_nghost-%COMP%]   main[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:0 40px}"]}),t})()}];let O=(()=>{class t{}return t.\u0275mod=l.Ib({type:t}),t.\u0275inj=l.Hb({factory:function(n){return new(n||t)},imports:[[s.i.forChild(p)],s.i]}),t})(),k=(()=>{class t{}return t.\u0275mod=l.Ib({type:t}),t.\u0275inj=l.Hb({factory:function(n){return new(n||t)},imports:[[i.c,o.a,c.s,O]]}),t})()}}]);